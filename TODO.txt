File: FLYINGARROWS_2021_12_23.gb
Tools: GBDK, Version: 2020.4.0.2
Engine: ZGB, Version: 2021.0
Music: GBT Player



LIV 0 ZOO -> Wolf -> tool per uscita
LIV 1 SEWER -> Gator -> stone
LIV 2 FOREST -> Eagle  -> tool per uscita
LIV 3 SKY -> Ibex -> thunder
LIV 4 TREES -> Bear -> tool di uscita
LIV 5 GROTTA CON STALATITI E STALAGMITI -> Walrus -> ice
LIV 6 CIMITERO -> 
				- finisce con la mamma davanti al cancello
				- terminare il design
				
LIV 7 CASTELLO -> 3 MAPPE
		- mappa 0 -> castello un po' labirintico, 
			- Nemici bomba, 
			- formica gigante che si forma da formichine piccole, immortale
			- fantasmi immortali però freezzabili
			- ad un certo punto devo fare una cutscene piccola di ri-chiusura del portone alle mie spalle. 
				Il finalBoss infatti ha preso l' amuleto del fuoco e lo userà al primo scontro con me.
		- bossFight 1 -> la cutscene qiui è importante perchè devo spiegare perchè il cattivone ha fatto avvicinare la luna. 
				che devo battere, perchè alla fine, "da morto" - viene menato dalla mamma con la balestra, rilascia la piramide di fuoco e scappa "giù". la mamma prende l' amuleto, cutscene in cui la mamma ce lo da e dice che deve andare sopra la torre da sola per "liberare le bestie".
		- mappa 1 torre -> vado con la mamma in cima - da sola
				stanze segrete per liberare i lupo, aquila, orso che erano stati messi in trappola dal finalBoss per punizione. 
				Se li colpisco, mi cacciano, se ci parlo, li curo e verranno dopo in aiuto.
				il finalboss l' attacca, la scena si sposta sull' arcere che deve rifare da solo 
		- mappa 2 torre -> le stanze segrete sono vuote. cronometro di 60secondi, se non arrivo in tempo, mamma muore GAME OVER
		- bossFight 2 -> in cima alla torre Ogni due colpi dati, arriva un boss vecchio che ferisce il cattivone. 
			Ho a disposizione frecce normali e frecce di fuoco per demolirlo. Alla fine arriva mamma , dice "insieme figlio!" 
			scoccano una freccia insieme, che diventa freccia di luce e colpisce il cattivone, sparandolo lontano dalla torre.
			cutscene dell' arcere e madre che escono dal cancello, senza più gli amuleti perchè diciamo di averceli tutti
			titoli di coda
			cutscene alla Gator Swamp col coccodrillo insieme al finalBoss.
			
---------------------------------------------------------
LIVELLI BONUS -> si controlla il boss senza amuleto e gli si fa fare na certa cosa. Se riesce, questo boss darà una mano al protagonista nello scontro finale
	- WOLF siamo al cimitero, il lupo ha una vx che aumenta, scopo è catturare 10 topi, al massimo si può saltare, e i topi sono o per terra o sopra una lapide. quando wolf arriva al cancello del castello, il livello è finito. se ha catturato 10 topi partecipa allo scontro contro il boss
	- EAGLE stesso processo, i topi sono o per terra o sopra gli alberi. l' aquila resta in volo e con "salto" va in picchiata
	- BEAR boh, uguale al wolf ma magari più lento, e ne deve beccare di più ?
---------------------------------------------------------


KNOWN ISSUE:
- colori viola della schermata cematery sul color
- annerire lo sfondo sulla schermata worldmap sul color
- mettere più scrigni a moneta singola in giro
- nel menu di pausa e nel worldmap sono mostrati gli amuleti posseduti non in base al quiver 
	ma in base al livello. Forse chissene, ma è da tenere come known issue.

TODO:
- completare l' upgrade ZGB v2021.3
	cematery
- menu di pausa: devo fermare tutti gli enemy in schermo 
	mettendo lo ENEMY_STATE_PAUSED dallo StateGame, non cambio state
- fare i loop audio da dare ad Antonio Coronato per preventivo
- piume che cadono quando colpisco l acquila
- fare tombe visitabili
- dare un animale alla mamma che aspetta, così alla cutscene va incontro al protagonista. 
	che si chiami e che abbia la foto di uno che paga su KS per avere il suo cane magari morto!!
- finire cutscene fine liv CIMITERO
- livello castello come da design sopra
- final boss
- bonus level

LORE:
Lore is about the Moon approaching the Earth, causing wild animals to develop intelligence,
 disarm human weapons and take over the power on earth.  
 Retaliation for humans now to be imprisoned in zoo-es. 
 Player controls the archer, a boy who has been freed by his mom. 
 He is able to use the power of elements and convey it inside his arrows. 
 This power-transfer is made through amulets he got to find. He starts with the Bow of Wind, 
 so he is basically able to fly arrows. Wild Animals keep amulets safe from humans, 
 he has to defeat em to get those amulets. Amulets are also mandatory to enter into the 
 final Castle, where his mother is waiting. The castle is where a crazy scientist makes 
 his work.. is he finding a solution for moon approaching, 
 or is he the responsible of that? if he is, why he did that? 
 an it be reverted? ... more deeply, is it worth to be reverted ? 
 were humans doing a good job on Earth itself, when they were at the most powerful 
 position on the chain ?

SOUND BACKGROUND PER OGNI LIVELLO : 
- sul drive di checco.1809 cartella ARROWS c'è il video di tutti i giri di Leonardo alla tastiera. 
Ho già messo in midi solo il primo. Mettere anche gli altri o salvarsi il video.

polish:
	- feedback audio di "swish" quando la freccia scheggia cancello senza romperlo
	- feedback audio "bling" quando freccia colpisce convertitore
	- feedback audio quando freccia colpisce ridirezione
	- sonoro di boss sconfitto - bg music loop corto e tranquillissimo/noioso perchè dura pochissimo quel che succede dopo.
	- camera in rolling per la diag del mostro
	- sonoro trionfale quando sollevo amulet
	- SOUND EFFECT DI 1UP
	- SOUND EFFECT DI SHIELD
	- SOUND EFFECT DI EXIT SENZA TOOL
	- BIIP ALL' INSERIMENTO DEL CHEAT CODE SULLA TITLESCREEN
	- frame arciere di cambio di direzione - che guardi il giocatore, a spalle verso il background - potrei sacrificare il frame di discesa
	- frame arciere quando cado dall' alto, quindi con quella custom_data _y più alta di #, aggiungere un frame di inginocchiato da tenere per 0.2 secondi
	- bordo cornice tutto schermo del livello bonus
	- sound del salto - ce lo ha anche superMarioLand!
	- sound per quando corro contro una parete
	- sound lancio freccia
	- sound quando viene spawnato un oggetto
	- sound quando viene spawnato un amuleto!
	- sound di quando lo scrigno si apre !	
	- You can see the player's health reset before the fadeout on death
	- effetto di camera tramble che potrebbe essere utile da usare come effetto
	- schermata di fine livello - direi con pergamena descrittiva
	- quando mi volto, sostituire lo scroll orizzontale tra i lati destro e sinistro

nice2have:
	- per family friendliness, coinvolgere anche il joypad2 sulla SNES, prendere spunto da:
			- https://github.com/gbdk-2020/gbdk-2020/blob/develop/gbdk-lib/examples/gb/sgb_pong/sgb_pong.c
			- https://github.com/gbdk-2020/gbdk-2020/blob/develop/gbdk-lib/examples/gb/sgb_multiplayer/sgb_multiplayer.c  

replay value:
start screen è selezione del livello. Si può scegliere ultimo livello del castello, ma verrà inquadrato un cancello attorno al quale depositare gli amuleti. solo coi 4 amuleti ottenuti il cancello si aprirà.
in questo modo chi ricomincia può andare a scegliere solo i livelli con gli amuleti e arrivare al castello.
dopo i boss senza amuleti si accede ad un livello bonus, se lo si supera, il boss del livello entra "in gioco" nello scontro finale col boss finale e lo picchia - buttandogli giù della vita.


CONTROLLO di tutti i suggerimenti/dialoghi

RICORDARSI ALLA FINE DI TUTTO DI SOSTITUIRE LE TILE DI
SECRET, ENTRATA BOSS, USCITA BOSS, HIDDEN ITEMS

disabilitare ri-entrata su sstanza secret. Facile, tutto a codice.

DIFFERENTI BORDI DI SNES PER LIVELLO


SHOULD I.. ?
- fare una nuova mappa secret con i posti di spawn switchati. Scrivere logica di posizionamento spawn e caricamento mappa a seconda del livello di gioco. pari o dispari.
- comparsa del testo lettera per lettera
- diag della tile che converte e ridireziona il tipo di freccia




PNG2MAP
C:\GB\ZGB-2021.3\tools\png2map\png2gbtiles.exe test2.png -gbm -g -pal=mypal.pal
maypal.pal file di testo contenente solo le seguenti
#C6D783
#8DCD53
#2D632F
#11380F
ovviamente palette del Paint.NET con cui ho fatto il png contiene gli stessi codici, senza # e con FF iniziali per azzerare opacità
png 160x144


BORDO sgb 
C:\GB\ZGBNEW\tools\border\

POTREI EVITARE DI USARE LA PRINT PER MOSTRARE GLI AMULETI
IN CAMBIO METTERE  tile sulla window:
unsigned char face[] = {TILE0, TILE2, TILE1, TILE3};
set_win_tiles(1, 2, 2, 2, face); // solito: (posx, posy, width, height, array di tiles in numeri interi)
così risparmio qualche posizione sullo spazio per gli sprite.

C:\GB\ZGBNEW\tools\romusage-main\bin\romusage.exe C:\GB\ZGBNEW\ZGB-template-master\Debug\ARROWS_Debug.noi -g

DISCORD MARKDOWN: ```c ```

StateWorldmap.c calls for a tile replacement: method WorldmapQuiverStone().
Tile replacement is inside my module TilesAnimations.c/.h
TilesAnimations0.c is:
```c
#include "Banks/SetAutoBank.h"
#include "ZGBMain.h"
IMPORT_TILES(tiles);
IMPORT_TILES(tilesanims);
IMPORT_TILES(tilesanimsmapworld);
extern UINT8 current_level;
extern UINT8 current_map;
extern UINT8 bank_tiles;
extern UINT8 bank_tilesanims;
extern UINT8 bank_tilesanimsmapworld;

void set_banked_bkg_data(UINT8 first_tile, UINT8 nb_tiles, const UINT8 *data, UINT8 bank) NONBANKED {
    uint8_t save = _current_bank;
    SWITCH_ROM(bank);   
    set_bkg_data(first_tile, nb_tiles, data);
    SWITCH_ROM(save);
}

void WorldmapQuiverStone(){
	set_banked_bkg_data(44u, 1u, tilesanims.data+16u, bank_tilesanims);// 16 * 1
}
```
As soon as StateWorldmap calls the method, all the game breaks.

Setting a breakpoint on that line, debug correctly stops there.
Setting a breakpoint inside my module, inside the method WorldmapQuiverStone(), it does not stops.

Why is the game breaking like that?




FLYING ARROWS 2 
come Predator 2 per Sega Master System. Mi piace molto quella prospettiva lì. Ho notato che su Sega Master System tutti i giochi USGold sono disegnati molto bene. Se ce ne fosse uno con un po' di profondità...
come TMNT 3 sulla NES
