                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 4.0.0 #11528 (MINGW32)
                              4 ;--------------------------------------------------------
                              5 	.module SpritePlatform
                              6 	.optsdcc -mgbz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _Destroy_SpritePlatform
                             12 	.globl _Update_SpritePlatform
                             13 	.globl _Start_SpritePlatform
                             14 	.globl _TranslateSprite
                             15 	.globl _SetSpriteAnim
                             16 	.globl _empty
                             17 	.globl _bank_SpritePlatform
                             18 	.globl _attack_wait
                             19 	.globl _damage_cooldown
                             20 	.globl _platform_normal
                             21 ;--------------------------------------------------------
                             22 ; special function registers
                             23 ;--------------------------------------------------------
                             24 ;--------------------------------------------------------
                             25 ; ram data
                             26 ;--------------------------------------------------------
                             27 	.area _DATA
   0000                      28 _damage_cooldown::
   0000                      29 	.ds 1
   0001                      30 _attack_wait::
   0001                      31 	.ds 1
                             32 ;--------------------------------------------------------
                             33 ; CODE rom data
                             34 ;--------------------------------------------------------
                             35 	.area _CODE
   0000                      36 _bank_SpritePlatform:
   0000 02                   37 	.db #0x02	; 2
                             38 ;--------------------------------------------------------
                             39 ; absolute external ram data
                             40 ;--------------------------------------------------------
                             41 	.area _DABS (ABS)
                             42 ;--------------------------------------------------------
                             43 ; global & static initialisations
                             44 ;--------------------------------------------------------
                             45 	.area _HOME
                             46 	.area _GSINIT
                             47 	.area _GSFINAL
                             48 	.area _GSINIT
                             49 ;custom_datas.h:54: UINT8 damage_cooldown = 30u;
   0000 21r00r00             50 	ld	hl, #_damage_cooldown
   0003 36 1E                51 	ld	(hl), #0x1e
                             52 ;custom_datas.h:55: UINT8 attack_wait = 32u;
   0005 21r01r00             53 	ld	hl, #_attack_wait
   0008 36 20                54 	ld	(hl), #0x20
                             55 ;--------------------------------------------------------
                             56 ; Home
                             57 ;--------------------------------------------------------
                             58 	.area _HOME
                             59 ;C:/GB/ZGB/common/include/Banks/SetBankCommon.h:4: void empty(void) __nonbanked {}
                             60 ;	---------------------------------
                             61 ; Function empty
                             62 ; ---------------------------------
   0000                      63 _empty::
   0000 C9                   64 	ret
                             65 	.area _HOME
                             66 ;--------------------------------------------------------
                             67 ; code
                             68 ;--------------------------------------------------------
                             69 	.area _CODE_2
                             70 ;SpritePlatform.c:11: void Start_SpritePlatform() {
                             71 ;	---------------------------------
                             72 ; Function Start_SpritePlatform
                             73 ; ---------------------------------
   0000                      74 _Start_SpritePlatform::
   0000 E8 FE                75 	add	sp, #-2
                             76 ;SpritePlatform.c:13: THIS->coll_x = 2;
   0002 21r01r00             77 	ld	hl, #_THIS + 1
   0005 2B                   78 	dec	hl
   0006 4E                   79 	ld	c, (hl)
   0007 23                   80 	inc	hl
   0008 46                   81 	ld	b, (hl)
   0009 21 0D 00             82 	ld	hl, #0x000d
   000C 09                   83 	add	hl, bc
   000D 4D                   84 	ld	c,l
   000E 7C                   85 	ld	a,h
   000F 36 02                86 	ld	(hl), #0x02
                             87 ;SpritePlatform.c:14: THIS->coll_y = 12;
   0011 21r01r00             88 	ld	hl, #_THIS + 1
   0014 2B                   89 	dec	hl
   0015 4E                   90 	ld	c, (hl)
   0016 23                   91 	inc	hl
   0017 46                   92 	ld	b, (hl)
   0018 21 0E 00             93 	ld	hl, #0x000e
   001B 09                   94 	add	hl, bc
   001C 4D                   95 	ld	c,l
   001D 7C                   96 	ld	a,h
   001E 36 0C                97 	ld	(hl), #0x0c
                             98 ;SpritePlatform.c:15: THIS->coll_w = 12;
   0020 21r01r00             99 	ld	hl, #_THIS + 1
   0023 2B                  100 	dec	hl
   0024 4E                  101 	ld	c, (hl)
   0025 23                  102 	inc	hl
   0026 46                  103 	ld	b, (hl)
   0027 21 0F 00            104 	ld	hl, #0x000f
   002A 09                  105 	add	hl, bc
   002B 4D                  106 	ld	c,l
   002C 7C                  107 	ld	a,h
   002D 36 0C               108 	ld	(hl), #0x0c
                            109 ;SpritePlatform.c:16: THIS->coll_h = 4;
   002F 21r01r00            110 	ld	hl, #_THIS + 1
   0032 2B                  111 	dec	hl
   0033 4E                  112 	ld	c, (hl)
   0034 23                  113 	inc	hl
   0035 46                  114 	ld	b, (hl)
   0036 21 10 00            115 	ld	hl, #0x0010
   0039 09                  116 	add	hl, bc
   003A 4D                  117 	ld	c,l
   003B 7C                  118 	ld	a,h
   003C 36 04               119 	ld	(hl), #0x04
                            120 ;SpritePlatform.c:17: THIS->lim_x = 255;
   003E 21r00r00            121 	ld	hl, #_THIS
   0041 46                  122 	ld	b, (hl)
   0042 23                  123 	inc	hl
   0043 4E                  124 	ld	c, (hl)
   0044 78                  125 	ld	a, b
   0045 C6 13               126 	add	a, #0x13
   0047 47                  127 	ld	b, a
   0048 30 01               128 	jr	NC,00103$
   004A 0C                  129 	inc	c
   004B                     130 00103$:
   004B 68                  131 	ld	l, b
   004C 61                  132 	ld	h, c
   004D 36 FF               133 	ld	(hl), #0xff
   004F 23                  134 	inc	hl
   0050 36 00               135 	ld	(hl), #0x00
                            136 ;SpritePlatform.c:18: THIS->lim_y = 255;
   0052 21r00r00            137 	ld	hl, #_THIS
   0055 46                  138 	ld	b, (hl)
   0056 23                  139 	inc	hl
   0057 4E                  140 	ld	c, (hl)
   0058 78                  141 	ld	a, b
   0059 C6 15               142 	add	a, #0x15
   005B 47                  143 	ld	b, a
   005C 30 01               144 	jr	NC,00104$
   005E 0C                  145 	inc	c
   005F                     146 00104$:
   005F 68                  147 	ld	l, b
   0060 61                  148 	ld	h, c
   0061 36 FF               149 	ld	(hl), #0xff
   0063 23                  150 	inc	hl
   0064 36 00               151 	ld	(hl), #0x00
                            152 ;SpritePlatform.c:19: SetSpriteAnim(THIS, platform_normal, 8u);
   0066 3E 08               153 	ld	a, #0x08
   0068 F5                  154 	push	af
   0069 33                  155 	inc	sp
   006A 21rA0r00            156 	ld	hl, #_platform_normal
   006D E5                  157 	push	hl
   006E 21r00r00            158 	ld	hl, #_THIS
   0071 2A                  159 	ld	a, (hl+)
   0072 66                  160 	ld	h, (hl)
   0073 6F                  161 	ld	l, a
   0074 E5                  162 	push	hl
   0075 CDr00r00            163 	call	_SetSpriteAnim
   0078 E8 05               164 	add	sp, #5
                            165 ;SpritePlatform.c:20: struct PlatformInfo* data_platform = (struct PlatformInfo*)THIS->custom_data;
   007A 21r01r00            166 	ld	hl, #_THIS + 1
   007D 2B                  167 	dec	hl
   007E 4E                  168 	ld	c, (hl)
   007F 23                  169 	inc	hl
   0080 46                  170 	ld	b, (hl)
   0081 21 19 00            171 	ld	hl, #0x0019
   0084 09                  172 	add	hl, bc
   0085 4D                  173 	ld	c, l
   0086 7C                  174 	ld	a, h
   0087 47                  175 	ld	b, a
                            176 ;SpritePlatform.c:21: data_platform->type = 0;
   0088 59                  177 	ld	e, c
   0089 50                  178 	ld	d, b
   008A 1A                  179 	ld	a, (de)
   008B E6 F8               180 	and	a, #0xf8
   008D 12                  181 	ld	(de),a
                            182 ;SpritePlatform.c:22: data_platform->distance = 200;
   008E 21 01 00            183 	ld	hl, #0x0001
   0091 09                  184 	add	hl, bc
   0092 33                  185 	inc	sp
   0093 33                  186 	inc	sp
   0094 E5                  187 	push	hl
   0095 E1                  188 	pop	hl
   0096 E5                  189 	push	hl
   0097 36 C8               190 	ld	(hl), #0xc8
                            191 ;SpritePlatform.c:23: data_platform->step = 0;
   0099 03                  192 	inc	bc
   009A 03                  193 	inc	bc
   009B AF                  194 	xor	a, a
   009C 02                  195 	ld	(bc), a
                            196 ;SpritePlatform.c:24: }
   009D E8 02               197 	add	sp, #2
   009F C9                  198 	ret
   00A0                     199 _platform_normal:
   00A0 01                  200 	.db #0x01	; 1
   00A1 00                  201 	.db #0x00	; 0
                            202 ;SpritePlatform.c:26: void Update_SpritePlatform() {
                            203 ;	---------------------------------
                            204 ; Function Update_SpritePlatform
                            205 ; ---------------------------------
   00A2                     206 _Update_SpritePlatform::
   00A2 E8 F4               207 	add	sp, #-12
                            208 ;SpritePlatform.c:27: struct PlatformInfo* data_platform = (struct PlatformInfo*)THIS->custom_data;
   00A4 21r00r00            209 	ld	hl, #_THIS
   00A7 46                  210 	ld	b, (hl)
   00A8 23                  211 	inc	hl
   00A9 4E                  212 	ld	c, (hl)
   00AA 78                  213 	ld	a, b
   00AB C6 19               214 	add	a, #0x19
   00AD 47                  215 	ld	b, a
   00AE 30 01               216 	jr	NC,00146$
   00B0 0C                  217 	inc	c
   00B1                     218 00146$:
   00B1 F8 02               219 	ldhl	sp,	#2
   00B3 70                  220 	ld	(hl), b
   00B4 23                  221 	inc	hl
   00B5 71                  222 	ld	(hl), c
                            223 ;SpritePlatform.c:28: UINT8 r = 0x1;//2;
   00B6 06 01               224 	ld	b, #0x01
                            225 ;SpritePlatform.c:29: if (data_platform->step < 30 | data_platform->step > 170){
   00B8 2B                  226 	dec	hl
   00B9 5E                  227 	ld	e, (hl)
   00BA 23                  228 	inc	hl
   00BB 56                  229 	ld	d, (hl)
   00BC 21 02 00            230 	ld	hl, #0x0002
   00BF 19                  231 	add	hl, de
   00C0 7D                  232 	ld	a, l
   00C1 54                  233 	ld	d, h
   00C2 F8 04               234 	ldhl	sp,	#4
   00C4 22                  235 	ld	(hl+), a
   00C5 72                  236 	ld	(hl), d
   00C6 2B                  237 	dec	hl
   00C7 5E                  238 	ld	e, (hl)
   00C8 23                  239 	inc	hl
   00C9 56                  240 	ld	d, (hl)
   00CA 1A                  241 	ld	a,(de)
   00CB 4F                  242 	ld	c,a
   00CC D6 1E               243 	sub	a, #0x1e
   00CE 3E 00               244 	ld	a, #0x00
   00D0 17                  245 	rla
   00D1 F8 0B               246 	ldhl	sp,	#11
   00D3 77                  247 	ld	(hl), a
   00D4 3E AA               248 	ld	a, #0xaa
   00D6 91                  249 	sub	a, c
   00D7 3E 00               250 	ld	a, #0x00
   00D9 17                  251 	rla
   00DA B6                  252 	or	a, (hl)
   00DB B7                  253 	or	a, a
   00DC 28 02               254 	jr	Z,00102$
                            255 ;SpritePlatform.c:30: r=0x7;//8;
   00DE 06 07               256 	ld	b, #0x07
   00E0                     257 00102$:
                            258 ;SpritePlatform.c:32: if(data_platform->step > 70 & data_platform->step < 130){
   00E0 3E 46               259 	ld	a, #0x46
   00E2 91                  260 	sub	a, c
   00E3 3E 00               261 	ld	a, #0x00
   00E5 17                  262 	rla
   00E6 F8 0B               263 	ldhl	sp,	#11
   00E8 77                  264 	ld	(hl), a
   00E9 79                  265 	ld	a, c
   00EA D6 82               266 	sub	a, #0x82
   00EC 3E 00               267 	ld	a, #0x00
   00EE 17                  268 	rla
   00EF A6                  269 	and	a,(hl)
   00F0 28 02               270 	jr	Z,00104$
                            271 ;SpritePlatform.c:33: r=0x7;//8;
   00F2 06 07               272 	ld	b, #0x07
   00F4                     273 00104$:
                            274 ;SpritePlatform.c:36: if (data_platform->step < (data_platform->distance/2)){
   00F4 F8 02               275 	ldhl	sp,#(3 - 1)
   00F6 5E                  276 	ld	e, (hl)
   00F7 23                  277 	inc	hl
   00F8 56                  278 	ld	d, (hl)
   00F9 21 01 00            279 	ld	hl, #0x0001
   00FC 19                  280 	add	hl, de
   00FD 7D                  281 	ld	a, l
   00FE 54                  282 	ld	d, h
   00FF F8 06               283 	ldhl	sp,	#6
   0101 22                  284 	ld	(hl+), a
   0102 72                  285 	ld	(hl), d
                            286 ;SpritePlatform.c:37: data_platform->vx = 1;
   0103 F8 02               287 	ldhl	sp,#(3 - 1)
   0105 5E                  288 	ld	e, (hl)
   0106 23                  289 	inc	hl
   0107 56                  290 	ld	d, (hl)
   0108 21 04 00            291 	ld	hl, #0x0004
   010B 19                  292 	add	hl, de
   010C 7D                  293 	ld	a, l
   010D 54                  294 	ld	d, h
   010E F8 08               295 	ldhl	sp,	#8
   0110 22                  296 	ld	(hl+), a
   0111 72                  297 	ld	(hl), d
                            298 ;SpritePlatform.c:35: if ((data_platform->step & r) == 0){
   0112 79                  299 	ld	a, c
   0113 A0                  300 	and	a, b
   0114 5F                  301 	ld	e,a
   0115 B7                  302 	or	a, a
   0116 C2r81r01            303 	jp	NZ, 00109$
                            304 ;SpritePlatform.c:36: if (data_platform->step < (data_platform->distance/2)){
   0119 23                  305 	inc	hl
   011A 23                  306 	inc	hl
   011B 71                  307 	ld	(hl), c
   011C F8 06               308 	ldhl	sp,#(7 - 1)
   011E 5E                  309 	ld	e, (hl)
   011F 23                  310 	inc	hl
   0120 56                  311 	ld	d, (hl)
   0121 1A                  312 	ld	a,(de)
   0122 4F                  313 	ld	c, a
   0123 06 00               314 	ld	b, #0x00
   0125 33                  315 	inc	sp
   0126 33                  316 	inc	sp
   0127 C5                  317 	push	bc
   0128 CB 78               318 	bit	7, b
   012A 28 04               319 	jr	Z,00115$
   012C 03                  320 	inc	bc
   012D 33                  321 	inc	sp
   012E 33                  322 	inc	sp
   012F C5                  323 	push	bc
   0130                     324 00115$:
   0130 C1                  325 	pop	bc
   0131 C5                  326 	push	bc
   0132 CB 28               327 	sra	b
   0134 CB 19               328 	rr	c
   0136 F8 0B               329 	ldhl	sp,	#11
   0138 3A                  330 	ld	a, (hl-)
   0139 77                  331 	ld	(hl), a
   013A AF                  332 	xor	a, a
   013B 23                  333 	inc	hl
   013C 32                  334 	ld	(hl-), a
   013D 7E                  335 	ld	a, (hl)
   013E 91                  336 	sub	a, c
   013F 23                  337 	inc	hl
   0140 7E                  338 	ld	a, (hl)
   0141 98                  339 	sbc	a, b
   0142 56                  340 	ld	d, (hl)
   0143 78                  341 	ld	a, b
   0144 5F                  342 	ld	e, a
   0145 CB 7B               343 	bit	7, e
   0147 28 07               344 	jr	Z,00147$
   0149 CB 7A               345 	bit	7, d
   014B 20 08               346 	jr	NZ,00148$
   014D BF                  347 	cp	a, a
   014E 18 05               348 	jr	00148$
   0150                     349 00147$:
   0150 CB 7A               350 	bit	7, d
   0152 28 01               351 	jr	Z,00148$
   0154 37                  352 	scf
   0155                     353 00148$:
   0155 30 09               354 	jr	NC,00106$
                            355 ;SpritePlatform.c:37: data_platform->vx = 1;
   0157 F8 08               356 	ldhl	sp,	#8
   0159 2A                  357 	ld	a, (hl+)
   015A 66                  358 	ld	h, (hl)
   015B 6F                  359 	ld	l, a
   015C 36 01               360 	ld	(hl), #0x01
   015E 18 07               361 	jr	00107$
   0160                     362 00106$:
                            363 ;SpritePlatform.c:39: data_platform->vx = -1;
   0160 F8 08               364 	ldhl	sp,	#8
   0162 2A                  365 	ld	a, (hl+)
   0163 66                  366 	ld	h, (hl)
   0164 6F                  367 	ld	l, a
   0165 36 FF               368 	ld	(hl), #0xff
   0167                     369 00107$:
                            370 ;SpritePlatform.c:41: TranslateSprite(THIS, data_platform->vx, 0);	
   0167 F8 08               371 	ldhl	sp,#(9 - 1)
   0169 5E                  372 	ld	e, (hl)
   016A 23                  373 	inc	hl
   016B 56                  374 	ld	d, (hl)
   016C 1A                  375 	ld	a,(de)
   016D 47                  376 	ld	b, a
   016E AF                  377 	xor	a, a
   016F F5                  378 	push	af
   0170 33                  379 	inc	sp
   0171 C5                  380 	push	bc
   0172 33                  381 	inc	sp
   0173 21r00r00            382 	ld	hl, #_THIS
   0176 2A                  383 	ld	a, (hl+)
   0177 66                  384 	ld	h, (hl)
   0178 6F                  385 	ld	l, a
   0179 E5                  386 	push	hl
   017A CDr00r00            387 	call	_TranslateSprite
   017D E8 04               388 	add	sp, #4
   017F 18 07               389 	jr	00110$
   0181                     390 00109$:
                            391 ;SpritePlatform.c:43: data_platform->vx = 0;
   0181 F8 08               392 	ldhl	sp,	#8
   0183 2A                  393 	ld	a, (hl+)
   0184 66                  394 	ld	h, (hl)
   0185 6F                  395 	ld	l, a
   0186 36 00               396 	ld	(hl), #0x00
   0188                     397 00110$:
                            398 ;SpritePlatform.c:45: data_platform->step += 1;
   0188 F8 04               399 	ldhl	sp,#(5 - 1)
   018A 5E                  400 	ld	e, (hl)
   018B 23                  401 	inc	hl
   018C 56                  402 	ld	d, (hl)
   018D 1A                  403 	ld	a,(de)
   018E 4F                  404 	ld	c, a
   018F 0C                  405 	inc	c
   0190 2B                  406 	dec	hl
   0191 2A                  407 	ld	a, (hl+)
   0192 66                  408 	ld	h, (hl)
   0193 6F                  409 	ld	l, a
   0194 71                  410 	ld	(hl), c
                            411 ;SpritePlatform.c:46: if (data_platform->step >= data_platform->distance){
   0195 F8 04               412 	ldhl	sp,#(5 - 1)
   0197 5E                  413 	ld	e, (hl)
   0198 23                  414 	inc	hl
   0199 56                  415 	ld	d, (hl)
   019A 1A                  416 	ld	a,(de)
   019B 23                  417 	inc	hl
   019C 5E                  418 	ld	e, (hl)
   019D 23                  419 	inc	hl
   019E 56                  420 	ld	d, (hl)
   019F F5                  421 	push	af
   01A0 1A                  422 	ld	a,(de)
   01A1 4F                  423 	ld	c, a
   01A2 F1                  424 	pop	af
   01A3 91                  425 	sub	a, c
   01A4 DArD3r01            426 	jp	C, 00113$
                            427 ;SpritePlatform.c:47: data_platform->step = 0;
   01A7 F8 04               428 	ldhl	sp,	#4
   01A9 2A                  429 	ld	a, (hl+)
   01AA 66                  430 	ld	h, (hl)
   01AB 6F                  431 	ld	l, a
   01AC 36 00               432 	ld	(hl), #0x00
                            433 ;SpritePlatform.c:48: THIS->x = data_platform->initx;		
   01AE 21r01r00            434 	ld	hl, #_THIS + 1
   01B1 2B                  435 	dec	hl
   01B2 4E                  436 	ld	c, (hl)
   01B3 23                  437 	inc	hl
   01B4 46                  438 	ld	b, (hl)
   01B5 21 08 00            439 	ld	hl, #0x0008
   01B8 09                  440 	add	hl, bc
   01B9 7D                  441 	ld	a, l
   01BA 54                  442 	ld	d, h
   01BB F8 0A               443 	ldhl	sp,	#10
   01BD 22                  444 	ld	(hl+), a
   01BE 72                  445 	ld	(hl), d
   01BF F8 02               446 	ldhl	sp,#(3 - 1)
   01C1 4E                  447 	ld	c, (hl)
   01C2 23                  448 	inc	hl
   01C3 46                  449 	ld	b, (hl)
   01C4 03                  450 	inc	bc
   01C5 03                  451 	inc	bc
   01C6 03                  452 	inc	bc
   01C7 0A                  453 	ld	a, (bc)
   01C8 4F                  454 	ld	c, a
   01C9 06 00               455 	ld	b, #0x00
   01CB F8 0A               456 	ldhl	sp,	#10
   01CD 2A                  457 	ld	a, (hl+)
   01CE 66                  458 	ld	h, (hl)
   01CF 6F                  459 	ld	l, a
   01D0 71                  460 	ld	(hl), c
   01D1 23                  461 	inc	hl
   01D2 70                  462 	ld	(hl), b
   01D3                     463 00113$:
                            464 ;SpritePlatform.c:50: }
   01D3 E8 0C               465 	add	sp, #12
   01D5 C9                  466 	ret
                            467 ;SpritePlatform.c:52: void Destroy_SpritePlatform() {
                            468 ;	---------------------------------
                            469 ; Function Destroy_SpritePlatform
                            470 ; ---------------------------------
   01D6                     471 _Destroy_SpritePlatform::
                            472 ;SpritePlatform.c:53: }
   01D6 C9                  473 	ret
                            474 	.area _CODE_2
                            475 	.area _CABS (ABS)
